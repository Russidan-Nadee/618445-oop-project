// Database Connection
datasource db {
   provider = "postgresql"
}

generator client {
   provider = "prisma-client-js"
}

// Enums
enum AssetStatus {
   AVAILABLE
   BORROWED
   BROKEN
   DISABLED
}

enum Role {
   ADMIN
   STAFF
   USER
}

// Models

// 1) Asset
model Asset {
   id           Int         @id @default(autoincrement())
   name         String
   serialNumber String
   status       AssetStatus @default(AVAILABLE)
   purchaseDate DateTime

   typeId Int
   type   AssetType @relation(fields: [typeId], references: [id])

   transactions Transaction[]
}

// 2) AssetType
model AssetType {
   id   Int    @id @default(autoincrement())
   name String

   assets Asset[]
}

// 3) User
model User {
   id       Int    @id @default(autoincrement())
   fullName String
   email    String @unique
   role     Role   @default(USER)

   transactions Transaction[]
   logs         Log[]
}

// 4) Transaction
model Transaction {
   id         Int      @id @default(autoincrement())
   action     String // borrow | return
   actionDate DateTime
   note       String?

   userId  Int
   assetId Int

   user  User  @relation(fields: [userId], references: [id])
   asset Asset @relation(fields: [assetId], references: [id])
}

// 5) Log
model Log {
   id        Int      @id @default(autoincrement())
   action    String
   targetId  Int
   timestamp DateTime @default(now())

   userId Int
   user   User @relation(fields: [userId], references: [id])
}
